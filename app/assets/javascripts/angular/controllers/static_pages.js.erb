app.controller('StaticPagesCtrl', ['$scope', '$auth', '$location', '$routeParams', '$http', function($scope, $auth, $location, $routeParams, $http){

  $scope.message = "Planit";

  $scope.login = function () {
    $auth.submitLogin($scope.loginForm).
      then(function(resp) {
        console.log(resp);
        $location.path('/trips');
      }).
      catch(function(resp) {
        console.log(resp);
      });
  };

  $scope.signup = function () {
    $auth.submitRegistration($scope.registrationForm).
      then(function(resp) {
        if ($routeParams.secure_hash) {
          var user_id = resp.data.data.id;
          $http({
            url: '/members/join_by_hash',
            method: 'POST',
            data: {
              user_id: user_id,
              secure_hash: $routeParams.secure_hash
            }
          }).then(function (resp) {
            $location.path('/trips');
          }, function (resp) {
            // error
          })
        } else {
          $location.path('/trips');
        }
      }).
      catch(function(resp) {
        console.log(resp);
      });
  };

}]);